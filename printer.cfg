[include mainsail.cfg]
#[include helpers.cfg]
[include sovol-macros.cfg]
[include timelapse.cfg]
[include GP3D_Macro.cfg]
[include test_speed.cfg]
[include KAMP_Settings.cfg]
[include status-macros.cfg]
[include new-macros.cfg]
[include steppers.cfg]
#[include carto.cfg]
[include eddy.cfg]
[include fans-and-temp-sensors.cfg]
[include moonraker_obico_macros.cfg]

[include options/lcd/*.cfg]
# [include options/hdmi/*.cfg]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f103xe_32FFD5054747393934692057-if00
restart_method: command

[mcu extra_mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f103xe_50FF69068367515546441367-if00
restart_method: command

[printer]
kinematics: corexy
max_velocity: 700
# printer max 40k
# input shaping says <= 8700 for x, <= 4100 for y
max_accel: 20000
minimum_cruise_ratio: 0.5
max_z_velocity: 20
max_z_accel: 500
square_corner_velocity: 5.0
autosave_path: ../backup

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[force_move]
enable_force_move: true

[extruder]
rotation_distance: 6.738 #6.745 #6.5
nozzle_diameter: 0.400
filament_diameter: 1.75
# for purge
max_extrude_cross_section: 6

[thermistor my_thermistor_e]
temperature1:25
resistance1:110000
temperature2:100
resistance2:7008
temperature3:220
resistance3:435

[verify_heater extruder]
max_error: 120
check_gain_time:30
hysteresis: 5
heating_gain: 2

[filament_switch_sensor filament_sensor]
pause_on_runout: True
event_delay: 3.0
pause_delay: 0.5
switch_pin: PE9

[thermistor my_thermistor]
temperature1:25
resistance1:100000
temperature2:50
resistance2:18085.4
temperature3:100
resistance3:5362.6

[heater_bed]
heater_pin:PA0
sensor_type: my_thermistor
sensor_pin: PC5
max_power: 1.0
min_temp: 5
max_temp: 105
#control : pid
#pid_kp : 73.571
#pid_ki : 1.820
#pid_kd : 783.849

[verify_heater heater_bed]
max_error: 120
check_gain_time:40
hysteresis: 5
heating_gain: 2

[probe_pressure]
pin: ^!PE12
x_offset: 0
y_offset: 0
z_offset : 0
speed: 1.0

[quad_gantry_level]
gantry_corners:
	-60,-10
	410,420
points:
	36,10
	36,320
	346,320
	346,10
speed: 400
horizontal_move_z: 2.0 #3 #5 # orig 10
retry_tolerance: 0.02 # orig 0.05 # someone had .008 which is nuts?
retries: 10 # orig 5
max_adjust: 10 # orig 30

[gcode_macro CENTER]
gcode:
    G90 ; set absolute positioning
    G0 X177.5 Y177.5 F6000 ; return to center
    M400

[homing_override]
gcode:
  # Move 5 up, just in case (this is our safety zhop, this needs 'set_position_z: 0' below)
  STATUS_HOMING
  G91 ; set relative positioning
  G0 Z5 F1000 ; 5 up zhop
  {% if not rawparams or 'Y' in rawparams|upper %}
    {action_respond_info('Homing Y')}
    G28 Y
    ;;G91 ; set relative positioning
    ;;G0 Y-30 F600 ; move a bit out
    ;;G28 Y ; then re-home Y, just in case we hit the motor klunk
    G90 ; set absolute positioning
    G0 Y177.5 F6000 ; return to center
    M400 ; Wait for move to finish
  {% endif %}
  {% if not rawparams or 'X' in rawparams|upper %}
    {action_respond_info('Homing X')}
    G28 X
    G90 ; set absolute positioning
    G0 X177.5 F6000 ; return to center
    M400 ; Wait for move to finish
  {% endif %}
  {% if not rawparams or 'Z' in rawparams|upper %}
    {action_respond_info('Homing Z')}
    G90 ; set absolute positioning
    G0 X177.5 Y177.5 F6000 ; return to center, please add your offsets manually if you want to
    G28 Z ; do the coarse home
    G90 ; set absolute positioning
    G0 Z2 F1000 ; to 2mm ; TODO -- do we need this?
    G4 S1 ; chill for a sec
    M400 ; Wait for move to finish
    PROBE_EDDY_NG_PROBE_STATIC
    SET_Z_FROM_PROBE
    G0 Z5 F1000 ; to 5mm as home
  {% endif %}
  G90 ; set absolute positioning
  STATUS_READY
axes: xyz
set_position_z: 0 # This forces the z position to be at 0 when we start homing, so we can move the Z up before homing.

[gcode_arcs]
resolution: 1.0

[idle_timeout]
gcode: _IDLE_TIMEOUT
timeout: 600

[pause_resume]

[exclude_object]

[firmware_retraction]

[adxl345]
cs_pin:extra_mcu:PB12

[resonance_tester]
accel_chip: adxl345
probe_points:
    175, 175, 30  # an example175 Y175 Z30
#accel_per_hz:50
min_freq:1
max_freq:120
#max_smoothing:0.2
#hz_per_sec:0.5

[input_shaper]
#damping_ratio_x: 0.001
#damping_ratio_y: 0.001
shaper_type_x = mzv
shaper_freq_x = 54.2
shaper_type_y = mzv
shaper_freq_y = 37

[save_variables]
filename = ~/printer_data/config/saved_variables.cfg

# 	10.050000:3151869.395,15.050156:3149390.215,20.049844:3148564.754,
# 	25.050000:3148201.192

# was 2.492 (automatic)
# was 2.055 (manual)
# was 1.888 -- got some good prints out of this with orange ASA, but then it's terrible
# automatic probe gave me 2.54 after the 1.888
# # manual probing gave me 2.276
## [probe]
## z_offset = 2.246
##

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 27.832
#*# pid_ki = 4.315
#*# pid_kd = 44.878
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 73.349
#*# pid_ki = 1.948
#*# pid_kd = 690.394
#*#
#*# [probe_eddy_ng btt_eddy]
#*# calibration_15 = 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
#*# calibrated_drive_currents = 15, 16
#*# calibration_version = 3
#*# calibration_16 = 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
