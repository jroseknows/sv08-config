[include mainsail.cfg]
#[include helpers.cfg]
[include sovol-macros.cfg]
[include timelapse.cfg]
[include GP3D_Macro.cfg]
[include test_speed.cfg]
[include KAMP_Settings.cfg]
[include status-macros.cfg]
[include new-macros.cfg]
[include steppers.cfg]
[include eddy.cfg]
[include fans-and-temp-sensors.cfg]
[include moonraker_obico_macros.cfg]

[include options/lcd/*.cfg]
# [include options/hdmi/*.cfg]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f103xe_32FFD5054747393934692057-if00
restart_method: command

[mcu extra_mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f103xe_50FF69068367515546441367-if00
restart_method: command

[printer]
kinematics: corexy
max_velocity: 700
# printer max 40k
# input shaping says <= 8700 for x, <= 4100 for y
max_accel: 20000
minimum_cruise_ratio: 0.5
max_z_velocity: 20
max_z_accel: 500
square_corner_velocity: 5.0
autosave_path: ../backup

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[force_move]
enable_force_move: true

[extruder]
rotation_distance: 6.738 #6.745 #6.5
nozzle_diameter: 0.400
filament_diameter: 1.75
# for purge
max_extrude_cross_section: 6

[thermistor my_thermistor_e]
temperature1:25
resistance1:110000
temperature2:100
resistance2:7008
temperature3:220
resistance3:435

[verify_heater extruder]
max_error: 120
check_gain_time:30
hysteresis: 5
heating_gain: 2

[filament_switch_sensor filament_sensor]
pause_on_runout: True
event_delay: 3.0
pause_delay: 0.5
switch_pin: PE9

[thermistor my_thermistor]
temperature1:25
resistance1:100000
temperature2:50
resistance2:18085.4
temperature3:100
resistance3:5362.6

[heater_bed]
heater_pin:PA0
sensor_type: my_thermistor
sensor_pin: PC5
max_power: 1.0
min_temp: 5
max_temp: 105
#control : pid
#pid_kp : 73.571
#pid_ki : 1.820
#pid_kd : 783.849

[verify_heater heater_bed]
max_error: 120
check_gain_time:40
hysteresis: 5
heating_gain: 2

[probe_pressure]
pin: ^!PE12
x_offset: 0
y_offset: 0
z_offset : 0
speed: 1.0

[quad_gantry_level]
gantry_corners:
	-60,-10
	410,420
points:
	36,10
	36,320
	346,320
	346,10
speed: 400
horizontal_move_z: 5 # orig 10
retry_tolerance: 0.02 # orig 0.05 # someone had .008 which is nuts?
retries: 10 # orig 5
max_adjust: 10 # orig 30

[gcode_arcs]
resolution: 1.0

[idle_timeout]
gcode: _IDLE_TIMEOUT
timeout: 600

[pause_resume]

[exclude_object]

[firmware_retraction]

[adxl345]
cs_pin:extra_mcu:PB12

[resonance_tester]
accel_chip: adxl345
probe_points:
    175, 175, 30  # an example175 Y175 Z30
#accel_per_hz:50
min_freq:1
max_freq:120
#max_smoothing:0.2
#hz_per_sec:0.5

[input_shaper]
#damping_ratio_x: 0.001
#damping_ratio_y: 0.001
shaper_type_x = mzv
shaper_freq_x = 54.2
shaper_type_y = mzv
shaper_freq_y = 37

[save_variables]
filename = ~/printer_data/config/saved_variables.cfg

# 	10.050000:3151869.395,15.050156:3149390.215,20.049844:3148564.754,
# 	25.050000:3148201.192

# was 2.492 (automatic)
# was 2.055 (manual)
# was 1.888 -- got some good prints out of this with orange ASA, but then it's terrible
# automatic probe gave me 2.54 after the 1.888
# # manual probing gave me 2.276
## [probe]
## z_offset = 2.246
##

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 29.965104
#*# drift_calibration =
#*# 	3190592.496846, -694.924790, 6.206531
#*# 	3182979.984821, -546.264550, 4.810348
#*# 	3176111.624232, -395.754152, 3.357374
#*# 	3171244.796001, -306.225138, 2.526441
#*# 	3167229.044236, -233.145083, 1.859100
#*# 	3163905.965140, -169.925795, 1.254175
#*# 	3161480.778245, -132.498730, 0.904770
#*# 	3159491.160766, -102.247156, 0.622214
#*# 	3157558.809479, -67.777904, 0.304027
#*# drift_calibration_min_temp = 37.57907291782941
#*#
#*# [probe_eddy_current btt_eddy]
#*# calibrate =
#*# 	0.050156:3267289.760,0.090000:3265014.192,0.129844:3262728.270,
#*# 	0.170156:3260401.663,0.210000:3258055.534,0.249844:3255806.594,
#*# 	0.290156:3253526.030,0.330000:3251246.957,0.369844:3249090.577,
#*# 	0.410156:3246950.576,0.450000:3244795.396,0.489844:3242673.591,
#*# 	0.530156:3240596.829,0.570000:3238541.415,0.609844:3236484.831,
#*# 	0.650156:3234491.000,0.690000:3232455.017,0.729844:3230529.252,
#*# 	0.770156:3228585.683,0.810000:3226701.179,0.849844:3224910.720,
#*# 	0.890156:3223136.594,0.930000:3221370.905,0.969844:3219654.843,
#*# 	1.010156:3217963.014,1.050000:3216325.324,1.089844:3214743.515,
#*# 	1.130156:3213154.743,1.170000:3211545.840,1.209844:3210032.142,
#*# 	1.250156:3208515.832,1.290000:3207059.569,1.329844:3205620.553,
#*# 	1.370156:3204213.447,1.410000:3202845.168,1.449844:3201527.488,
#*# 	1.490156:3200254.887,1.530000:3198909.931,1.569844:3197660.982,
#*# 	1.610156:3196449.230,1.650000:3195245.975,1.689844:3194039.630,
#*# 	1.730156:3192893.423,1.770000:3191762.255,1.809844:3190652.140,
#*# 	1.850156:3189557.067,1.890000:3188530.743,1.929844:3187491.619,
#*# 	1.970156:3186487.940,2.010000:3185538.104,2.049844:3184590.488,
#*# 	2.090156:3183637.373,2.130000:3182698.599,2.169844:3181779.070,
#*# 	2.210156:3180879.709,2.250000:3179988.738,2.289844:3179156.717,
#*# 	2.330156:3178322.183,2.370000:3177489.588,2.409844:3176708.086,
#*# 	2.450156:3175928.156,2.490000:3175165.877,2.529844:3174411.732,
#*# 	2.570156:3173710.637,2.610000:3172979.951,2.649844:3172270.101,
#*# 	2.690156:3171561.821,2.730000:3170875.177,2.769844:3170215.493,
#*# 	2.810156:3169557.590,2.850000:3168917.160,2.889844:3168283.548,
#*# 	2.930156:3167666.558,2.970000:3167078.855,3.009844:3166518.960,
#*# 	3.050156:3165955.653,3.090000:3165355.999,3.129844:3164822.767,
#*# 	3.170156:3164258.246,3.210000:3163702.074,3.249844:3163178.111,
#*# 	3.290156:3162688.318,3.330000:3162166.616,3.369844:3161680.069,
#*# 	3.410156:3161180.084,3.450000:3160694.414,3.489844:3160283.398,
#*# 	3.530156:3159837.212,3.570000:3159382.900,3.609844:3158954.267,
#*# 	3.650156:3158510.347,3.690000:3158070.363,3.729844:3157659.060,
#*# 	3.770156:3157243.498,3.810000:3156859.270,3.849844:3156437.895,
#*# 	3.890156:3156082.990,3.930000:3155689.800,3.969844:3155327.508,
#*# 	4.010156:3154989.111,4.050000:3154623.538
#*# reg_drive_current = 15
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.112436, 0.069354, -0.001018, -0.044153, -0.097650, -0.109720, -0.107824, -0.099893, -0.096141, -0.104380, -0.077359, -0.052044, -0.022944, -0.002107, 0.031450
#*# 	0.018127, 0.005266, -0.046081, -0.076109, -0.093045, -0.107089, -0.103259, -0.116142, -0.107089, -0.094941, -0.090454, -0.071882, -0.049937, -0.015232, 0.011886
#*# 	0.053858, 0.037611, 0.003423, -0.017042, -0.040179, -0.085410, -0.069079, -0.079775, -0.052173, -0.071322, -0.049937, -0.027194, -0.015232, 0.016660, 0.014817
#*# 	0.055795, 0.036069, 0.003423, -0.026800, -0.040297, -0.062179, -0.058384, -0.058384, -0.049937, -0.057952, -0.023731, -0.028728, -0.022157, 0.014817, 0.003423
#*# 	0.087043, 0.071311, 0.035278, 0.003423, -0.009479, -0.026800, -0.034512, -0.053295, -0.043759, -0.029122, -0.019482, -0.026407, -0.007636, 0.008952, -0.007636
#*# 	0.096879, 0.094503, 0.045359, 0.019927, -0.007260, -0.011376, -0.013304, -0.013697, -0.022551, -0.006169, -0.015232, -0.000640, -0.006883, 0.025499, 0.009664
#*# 	0.108277, 0.081142, 0.026923, 0.001203, 0.006357, -0.011769, -0.010235, -0.032584, -0.024229, -0.031942, -0.026800, -0.013697, -0.006169, -0.005793, -0.000263
#*# 	0.121271, 0.106713, 0.056589, 0.029521, 0.027678, 0.003423, 0.018178, 0.016660, 0.011888, 0.008576, -0.003950, -0.001730, 0.018503, 0.018130, 0.039152
#*# 	0.085888, 0.088605, 0.046110, 0.007872, 0.003423, -0.003950, 0.001203, -0.027941, -0.008012, -0.011769, -0.026407, -0.018694, -0.003950, -0.007260, 0.021061
#*# 	0.087043, 0.082706, 0.046505, 0.012219, -0.003950, -0.004326, -0.013304, -0.021016, -0.015232, -0.011376, -0.018694, -0.005793, 0.010419, 0.009664, 0.022904
#*# 	0.075644, 0.052316, 0.016238, 0.001956, -0.009103, -0.024085, -0.008012, -0.026407, -0.015232, -0.016517, -0.008865, -0.001492, 0.031495, 0.009664, 0.022858
#*# 	0.061606, 0.045359, 0.003423, -0.028335, -0.043759, -0.042225, -0.048009, -0.046081, -0.032978, -0.032584, -0.019088, -0.005793, 0.004846, 0.005223, 0.028387
#*# 	0.086639, 0.052316, 0.003423, -0.022944, -0.012950, -0.044153, -0.042225, -0.049543, -0.036441, -0.023338, -0.024479, -0.003950, 0.021483, 0.036069, 0.046901
#*# 	0.075243, 0.032195, -0.018694, -0.048009, -0.067656, -0.082449, -0.086675, -0.080335, -0.080335, -0.057090, -0.044153, -0.019088, 0.007821, 0.035674, 0.072876
#*# 	0.112812, 0.046901, -0.028728, -0.077791, -0.109333, -0.118811, -0.105928, -0.096102, -0.087494, -0.082449, -0.054157, -0.027194, 0.005266, 0.059274, 0.110594
#*# x_count = 15
#*# y_count = 15
#*# mesh_x_pps = 3
#*# mesh_y_pps = 3
#*# algo = bicubic
#*# tension = 0.5
#*# min_x = 15.0
#*# max_x = 333.92
#*# min_y = 15.0
#*# max_y = 332.94
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 27.832
#*# pid_ki = 4.315
#*# pid_kd = 44.878
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 73.349
#*# pid_ki = 1.948
#*# pid_kd = 690.394
